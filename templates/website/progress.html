<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Progress Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 640 512'%3E%3Cpath fill='black' d='M622.34 153.2c12.46 4.86 20.66 16.79 20.66 30.2s-8.2 25.34-20.66 30.2L512 256.9v58.5c0 8.5-5.1 16.2-12.9 19.4l-144 64c-5.2 2.3-11.1 2.3-16.3 0l-144-64c-7.8-3.2-12.9-10.9-12.9-19.4v-58.5L17.66 213.6C5.2 208.7-3 196.8-3 183.4s8.2-25.3 20.7-30.2l300-116.2c7.8-3 16.6-3 24.4 0l280.24 116zM320 64L80 160l240 96 240-96L320 64zM480 384v96h32v-96h-32z'/%3E%3C/svg%3E">
 
 <style>
    body {
      background: #f4f6f9;
      font-family: 'Poppins', sans-serif;
      color: #333;
    }

    /* Cards */
    .card {
      border-radius: 1rem;
      transition: transform 0.3s, box-shadow 0.3s;
      border: none;
      background: linear-gradient(145deg, #ffffff, #e9ecef);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }

    .card:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
    }

    .card i {
      font-size: 2.2rem;
    }

    h3,
    h5 {
      font-weight: 600;
    }

    h3 {
      color: #0d6efd;
    }

    /* Progress bar */
    .progress {
      height: 28px;
      border-radius: 25px;
      overflow: hidden;
      background-color: #e9ecef;
    }

    .progress-bar {
      font-weight: 600;
      line-height: 28px;
      transition: width 1s ease-in-out;
    }

    .badge {
      font-size: 0.85rem;
      padding: 0.35em 0.8em;
    }

    canvas {
      max-width: 100% !important;
    }

    /* Page Header */
    .page-header {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .page-header h3 {
      margin-bottom: 0.5rem;
    }

    /* Responsive adjustments */
    @media (max-width: 992px) {
      h3 {
        font-size: 1.8rem;
      }

      h5 {
        font-size: 1.1rem;
      }

      .progress {
        height: 24px;
      }
    }

    @media (max-width: 768px) {
      .card i {
        font-size: 1.8rem;
      }

      h3 {
        font-size: 1.6rem;
      }

      h5 {
        font-size: 1rem;
      }

      .progress {
        height: 22px;
      }

      .page-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }
    }

    @media (max-width: 576px) {
      .card {
        padding: 1rem !important;
      }

      h3 {
        font-size: 1.4rem;
      }

      h5 {
        font-size: 0.95rem;
      }

      .progress {
        height: 20px;
      }
    }
  </style>
</head>

<body class="p-4">

  <div class="container">

    <!-- Page Header -->
    <div class="page-header">
      <h3><i class="fas fa-chart-line me-2"></i>Student Progress Dashboard</h3>
      <a href="#" class="btn btn-outline-primary" onclick="location.reload()">
        <i class="fas fa-sync-alt me-1"></i> Refresh
      </a>

    </div>

    <!-- Overview Cards -->
    <div class="row g-4 mb-4">
      <div class="col-md-3 col-sm-6 col-12">
        <div class="card text-center p-4">
          <i class="fas fa-tasks text-primary mb-3"></i>
          <h5>Total Assignments</h5>
          <p class="fs-5 fw-bold">{{ total }}</p>
        </div>
      </div>
      <div class="col-md-3 col-sm-6 col-12">
        <div class="card text-center p-4">
          <i class="fas fa-check-circle text-success mb-3"></i>
          <h5>Completed</h5>
          <p class="fs-5 fw-bold">{{ completed }}</p>
        </div>
      </div>
      <div class="col-md-3 col-sm-6 col-12">
        <div class="card text-center p-4">
          <i class="fas fa-hourglass-half text-warning mb-3"></i>
          <h5>Incomplete</h5>
          <p class="fs-5 fw-bold">{{ incomplete }}</p>
        </div>
      </div>
      <div class="col-md-3 col-sm-6 col-12">
        <div class="card text-center p-4">
          <i class="fas fa-star text-{{ color }} mb-3"></i>
          <h5>Average Marks</h5>
          <p class="fs-5 fw-bold">{{ avg_marks }}%</p>
          <span class="badge bg-{{ color }}">{{ status }}</span>
        </div>
      </div>
    </div>

    <!-- Progress Bar -->
    <div class="card p-4 mb-4">
      <h5 class="mb-3"><i class="fas fa-chart-bar me-2"></i>Overall Progress</h5>
      <div class="progress mb-2">
        <div class="progress-bar bg-{{ color }}" style="width: {{ progress }}%">
          {{ progress }}%
        </div>
      </div>
    </div>

    <!-- Charts Row -->
    <div class="row g-4">
      <div class="col-lg-8 col-md-12">
        <div class="card p-4 shadow-sm">
          <h5 class="text-center mb-3"><i class="fas fa-chart-column me-2"></i>Assignment Marks</h5>
          <canvas id="marksChart" height="180"></canvas>
        </div>
      </div>
      <div class="col-lg-4 col-md-12">
        <div class="card p-4 shadow-sm">
          <h5 class="text-center mb-3"><i class="fas fa-pie-chart me-2"></i>Submission Overview</h5>
          <canvas id="submissionChart" height="180"></canvas>
        </div>
      </div>
    </div>

  </div>

  <script>
    const chartData = {{ chart_data| tojson }};

    // Marks Bar Chart
    new Chart(document.getElementById('marksChart'), {
      type: 'bar',
      data: {
        labels: chartData.map(d => d.title),
        datasets: [{
          label: 'Marks',
          data: chartData.map(d => d.marks),
          backgroundColor: chartData.map(d => 'rgba(54, 162, 235, 0.7)'),
          borderColor: chartData.map(d => 'rgba(54, 162, 235, 1)'),
          borderWidth: 1,
          borderRadius: 5
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: false } },
        scales: {
          y: { beginAtZero: true, max: 100 },
          x: { ticks: { autoSkip: false } }
        }
      }
    });

    // Submission Pie Chart
    new Chart(document.getElementById('submissionChart'), {
      type: 'doughnut',
      data: {
        labels: ['Submitted', 'Not Submitted'],
        datasets: [{
          data: [
            chartData.filter(d => d.submitted).length,
            chartData.filter(d => !d.submitted).length
          ],
          backgroundColor: ['#198754', '#dc3545'],
          hoverOffset: 6,
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { position: 'bottom' } }
      }
    });
  </script>
</body>

</html>